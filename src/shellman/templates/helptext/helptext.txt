{% if doc.sections.usage %}
Usage: {{ doc.sections.usage[0].program }} {{ doc.sections.usage[0].command }}
{% for usage in doc.sections.usage[1:] %}
       {{ usage.program }} {{ usage.command }}
{% endfor %}

{% endif %}
{% if doc.sections.desc %}
{% for desc in doc.sections.desc %}
{{ desc.text|smart_width(0) }}
{% if not loop.last %}{{ "\n" }}{% endif %}
{% endfor %}

{% endif %}
{% if doc.sections.option %}
Options:
{% set width=22 %}
{% for opt_group, opt_list in doc.sections.option|groupby_unsorted('group') %}
{% if opt_group %}
{{ ' ' * (context.indent / 2)|int }}{{ opt_group }}:
{% endif %}
{% for option in opt_list %}
{{ context.indent_str }}{{ "{sign:{width}}"|format(sign=option.signature, width=width-1-context.indent) }} {% if option.signature|length > width-2-context.indent %}{{ '\n' + option.description|smart_width(context.indent + width-context.indent) + '\n' }}{% else %}{{ option.description|smart_width(context.indent + width-context.indent, indentfirst=False) + '\n' }}{% endif %}
{% endfor %}
{% if not loop.last %}{{ '\n' }}{% endif %}
{% endfor %}

{% endif %}
{% if doc.sections.env %}
Environment Variables:
{% for env in doc.sections.env %}
{{ context.indent_str }}{{ env.name }}
{{ env.description|smart_width(context.indent*2) }}
{% endfor %}

{% endif %}
{% if doc.sections.file %}
Files:
{% for file in doc.sections.file %}
{{ context.indent_str }}{{ file.name }}
{{ file.description|smart_width(context.indent*2) }}
{% endfor %}

{% endif %}
{% if doc.sections.exit %}
Exit Status:
{% for exit in doc.sections.exit %}
{{ context.indent_str }}{{ exit.code }}
{{ exit.description|smart_width(context.indent*2) }}
{% endfor %}

{% endif %}
{% if doc.sections.stdin %}

{% endif %}
{% if doc.sections.stdout %}

{% endif %}
{% if doc.sections.stderr %}

{% endif %}
{% if doc.sections.function %}
Functions:
{% for function in doc.sections.function %}
{% include "function.txt" with context %}
{% endfor %}

{% endif %}
{% if doc.sections.example %}
Examples:
{% for example in doc.sections.example %}
{{ context.indent_str }}{{ example.title }}
{% if example.code %}{{ "\n" + example.code|smart_width(context.indent*2) + "\n\n" }}{% endif %}
{% if example.explanation %}
{{ example.explanation|smart_width(context.indent*2) }}
{% endif %}
{% endfor %}
{% endif %}
{#
{% if doc.sections.error %}
Errors:
{% for error in doc.sections.error %}
{{ error.description|smart_width(context.indent) }}
{% if not loop.last %}{{ "\n" }}{% endif %}
{% endfor %}

{% endif %}
{% if doc.sections.bug %}
Bugs:
{% for bug in doc.sections.bug %}
{{ bug.description|smart_width(context.indent) }}
{% if not loop.last %}{{ "\n" }}{% endif %}
{% endfor %}

{% endif %}
{% if doc.sections.caveat %}
Caveats:
{% for caveat in doc.sections.caveat %}
{{ caveat.description|smart_width(context.indent) }}
{% if not loop.last %}{{ "\n" }}{% endif %}
{% endfor %}

{% endif %}
{% if doc.sections.author %}
Authors:
{% for author in doc.sections.author %}
{{ context.indent_str }}{{ author.text }}
{% if not loop.last %}{{ "\n" }}{% endif %}
{% endfor %}

{% endif %}
{% if doc.sections.copyright %}
Copyright:
{% for copyright in doc.sections.copyright %}
{{ copyright.text|smart_width(context.indent) }}
{% if not loop.last %}{{ "\n" }}{% endif %}
{% endfor %}

{% endif %}
{% if doc.sections.license %}
License:
{% for license in doc.sections.license %}
{{ license.text|smart_width(context.indent) }}
{% if not loop.last %}{{ "\n" }}{% endif %}
{% endfor %}

{% endif %}
{% if doc.sections.history %}
History:
{% for history in doc.sections.history %}
{{ history.text|smart_width(context.indent) }}
{% if not loop.last %}{{ "\n" }}{% endif %}
{% endfor %}

{% endif %}
{% if doc.sections.note %}
Notes:
{% for note in doc.sections.note %}
{{ note.text|smart_width(context.indent) }}
{% if not loop.last %}{{ "\n" }}{% endif %}
{% endfor %}

{% endif %}
{% if doc.sections.seealso %}
See Also:
{% for seealso in doc.sections.seealso %}
{{ seealso.text|smart_width(context.indent) }}
{% if not loop.last %}{{ "\n" }}{% endif %}
{% endfor %}
{% endif %}
#}
